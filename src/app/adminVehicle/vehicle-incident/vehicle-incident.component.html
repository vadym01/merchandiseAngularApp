<app-title [description]="'Инцидент'"></app-title>
<div class="form-container" *ngIf="showIncidentForm">
  <form (ngSubmit)="onSubmit()" #f="ngForm">
    <div class="main-info-container">
      <div class="form-group">
        <label for="incidentDescription">Описание</label>
        <input
          type="text"
          class="form-control"
          [ngModel]="incident?.incidentDescription"
          (ngModelChange)="(null)"
          name="incidentDescription"
        />
      </div>
      <div class="form-group">
        <label for="date">Дата инцыдента</label>
        <input
          type="date"
          class="form-control"
          [ngModel]="incident?.date"
          (ngModelChange)="(null)"
          name="date"
        />
      </div>
      <div>
        <div class="form-group">
          <label for="vehicleId">Id техники</label>
          <input
            type="number"
            class="form-control"
            [ngModel]="vehicle?.id"
            (ngModelChange)="(null)"
            name="vehicleId"
            disabled
          />
        </div>
        <div class="form-group">
          <label for="vehicleName">Название техники</label>
          <input
            type="text"
            class="form-control"
            [ngModel]="vehicle?.vehicleName"
            (ngModelChange)="(null)"
            name="vehicleName"
            disabled
          />
        </div>
      </div>
    </div>
    <div class="submit-form-group">
      <div class="submit-container">
        <button type="submit" id="submit-button"></button>
        <p>Сохранить</p>
      </div>
    </div>
  </form>
</div>

<app-vehicle-table
  [showActions]="true"
  [vehicles]="allVehicles"
  (vehicleInfoId)="setVehicleInfo($event)"
></app-vehicle-table>

<br />

<table class="styled-table">
  <thead>
    <tr>
      <th>Id</th>
      <th>Описание</th>
      <th>Дата инцидента</th>
      <th>Id тхники</th>
      <th>Название техники</th>
      <th>Действия</th>
    </tr>
  </thead>
  <tbody class="tbody-class">
    <tr *ngFor="let incident of incidents; let indexOfElement = index">
      <td>
        {{ incident.id }}
      </td>
      <td>
        {{ incident.incidentDescription }}
      </td>
      <td>
        {{ incident.date | date: "yyyy-MM-dd" }}
      </td>
      <td>
        {{ incident.vehicle.id }}
      </td>
      <td>
        {{ incident.vehicle.vehicleName }}
      </td>

      <td [ngStyle]="{ width: '100px' }">
        <button
          (click)="onDeleteIncidentClickHandler(incident.id, indexOfElement)"
        >
          Удалить инцидкнт
        </button>
        <button (click)="onUpdateClickHandler(indexOfElement)">
          Редактировать инцидкнт
        </button>
      </td>
    </tr>
  </tbody>
</table>
