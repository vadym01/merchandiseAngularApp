<app-title [description]="'Инцидент'"></app-title>
<div class="form-container" *ngIf="showIncidentForm">
  <form (ngSubmit)="onSubmit()" #f="ngForm">
    <div class="main-info-container">
      <div class="form-group">
        <label for="incidentDescription">Описание</label>
        <input
          type="text"
          id="incidentDescription"
          class="form-control"
          [ngModel]="incident?.incidentDescription"
          (ngModelChange)="(null)"
          name="incidentDescription"
        />
      </div>
      <div class="form-group">
        <label for="date">Дата инцыдента</label>
        <input
          type="date"
          id="date"
          class="form-control"
          [ngModel]="incident?.date"
          (ngModelChange)="(null)"
          name="date"
        />
      </div>
      <div>
        <div class="form-group">
          <label for="vehicleId">Id техники</label>
          <input
            type="number"
            id="vehicleId"
            class="form-control"
            [ngModel]="vehicle?.id"
            (ngModelChange)="(null)"
            name="vehicleId"
            disabled
          />
        </div>
        <div class="form-group">
          <label for="vehicleName">Название техники</label>
          <input
            type="text"
            id="vehicleName"
            class="form-control"
            [ngModel]="vehicle?.vehicleName"
            (ngModelChange)="(null)"
            name="vehicleName"
            disabled
          />
        </div>
        <!-- <div class="form-group incident-status">
          <input
            type="checkbox"
            id="incidentStatus"
            class="form-control"
            [ngModel]="incident?.isResolved"
            [value]="incident?.isResolved ? true : false"
            (ngModelChange)="(null)"
            name="incidentStatus"
          />
          <label for="incidentStatus">Статус инцидента</label>
        </div> -->
      </div>
    </div>
    <div class="submit-form-group">
      <div class="submit-container">
        <button type="submit" id="submit-button"></button>
        <p>Сохранить</p>
      </div>
    </div>
  </form>
</div>

<app-vehicle-table
  [showActions]="true"
  [vehicles]="allVehicles"
  (vehicleInfoId)="setVehicleInfo($event)"
></app-vehicle-table>

<br />
<app-title [description]="'История инцидентов'"></app-title>
<table class="styled-table">
  <thead>
    <tr>
      <th>Id</th>
      <th>Описание</th>
      <th>Дата инцидента</th>
      <th>Id тхники</th>
      <th>Название техники</th>
      <th>Действия</th>
    </tr>
  </thead>
  <tbody class="tbody-class">
    <tr
      *ngFor="let incident of incidents; let indexOfElement = index"
      [ngClass]="{ 'incident-actual': incident?.resolved === false }"
    >
      <td>
        {{ incident.id }}
      </td>
      <td>
        {{ incident.incidentDescription }}
      </td>
      <td>
        {{ incident.date | date: "yyyy-MM-dd" }}
      </td>
      <td>
        {{ incident.vehicle.id }}
      </td>
      <td>
        {{ incident.vehicle.vehicleName }}
      </td>

      <td [ngStyle]="{ width: '100px' }">
        <button
          (click)="onDeleteIncidentClickHandler(incident.id, indexOfElement)"
          class="button-action"
        >
          <i class="fa fa-trash" aria-hidden="true"></i>
        </button>
        <button
          (click)="onUpdateClickHandler(indexOfElement)"
          class="button-action"
        >
          <i class="fa fa-pencil" aria-hidden="true"></i>
        </button>
        <button
          (click)="onChangeStatusClickHandler(incident?.id)"
          class="button-action"
        >
          <i
            [ngClass]="
              incident?.resolved === false
                ? 'fa fa-toggle-on'
                : 'fa fa-toggle-off'
            "
            aria-hidden="true"
          ></i>
        </button>
      </td>
    </tr>
  </tbody>
</table>
